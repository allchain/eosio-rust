<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js ayu">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>eosio-rust</title>
        
        <meta name="robots" content="noindex" />
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "ayu";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('ayu')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div id="sidebar-scrollbox" class="sidebar-scrollbox">
                <ol class="chapter"><li class="expanded affix "><a href="index.html">Introduction</a></li><li class="spacer"></li><li class="expanded "><a href="getting-help.html"><strong aria-hidden="true">1.</strong> Getting Help</a></li><li class="expanded "><a href="install/index.html"><strong aria-hidden="true">2.</strong> Install</a></li><li><ol class="section"><li class="expanded "><a href="install/rust.html"><strong aria-hidden="true">2.1.</strong> Install Rust</a></li><li class="expanded "><a href="install/eos.html"><strong aria-hidden="true">2.2.</strong> Install EOS</a></li><li class="expanded "><a href="install/optional.html"><strong aria-hidden="true">2.3.</strong> Optional Dependencies</a></li></ol></li><li class="expanded "><a href="quick-start.html"><strong aria-hidden="true">3.</strong> Quick Start</a></li><li class="expanded "><a href="examples/index.html"><strong aria-hidden="true">4.</strong> Examples</a></li><li><ol class="section"><li class="expanded "><a href="examples/hello-bare.html"><strong aria-hidden="true">4.1.</strong> Hello, World!</a></li><li class="expanded "><a href="examples/hello.html"><strong aria-hidden="true">4.2.</strong> Hello, EOSIO Rust!</a></li><li class="expanded "><a href="examples/tic-tac-toe.html"><strong aria-hidden="true">4.3.</strong> Tic-Tac-Toe</a></li><li class="expanded "><a href="examples/addressbook.html"><strong aria-hidden="true">4.4.</strong> Address Book</a></li></ol></li><li class="expanded "><a href="guide/index.html"><strong aria-hidden="true">5.</strong> User Guide</a></li><li><ol class="section"><li class="expanded "><a href="guide/actions.html"><strong aria-hidden="true">5.1.</strong> Declaring Actions</a></li><li class="expanded "><a href="guide/tables.html"><strong aria-hidden="true">5.2.</strong> Declaring Tables</a></li><li class="expanded "><a href="guide/secondary-keys.html"><strong aria-hidden="true">5.3.</strong> Secondary Keys</a></li><li class="expanded "><a href="guide/traits.html"><strong aria-hidden="true">5.4.</strong> Deriving Common Traits</a></li><li class="expanded "><a href="guide/compiling.html"><strong aria-hidden="true">5.5.</strong> Compiling Smart Contracts</a></li><li class="expanded "><a href="guide/deploying.html"><strong aria-hidden="true">5.6.</strong> Deploying Smart Contracts</a></li><li class="expanded "><a href="guide/optimization.html"><strong aria-hidden="true">5.7.</strong> Optimizing WASM files</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu (default)</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title">eosio-rust</h1>

                        <div class="right-buttons">
                            <a href="print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                            
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#eosio-rust" id="eosio-rust">EOSIO Rust</a></h1>
<blockquote>
<p><strong>DISCLAIMER:</strong> <em>This project is in early development and we looking for feedback on all APIs and features. All APIs and features should be considered unstable and insecure until version <code>1.0</code> is released. This code is not yet suitable for production environments where user funds are at risk. Thank you.</em></p>
</blockquote>
<p>This project intends to enable developers to write full-stack EOSIO applications using the Rust programming language. We believe Rust is an excellent choice for EOSIO smart contract development with its focus on safety, speed, and WebAssembly. Furthermore, projects like <a href="https://github.com/rustwasm/wasm-bindgen/">wasm-bindgen</a> and <a href="https://github.com/koute/stdweb/">stdweb</a> make it possible to write full-stack Rust web applications, limiting the need for Javascript and enabling code reuse between browsers, servers, and smart contracts.</p>
<p>The primary goals of this project are to provide Rust crates that:</p>
<ul>
<li>Enable developers to write secure EOSIO smart contracts.</li>
<li>Streamline the development of full-stack EOSIO web applications.</li>
<li>Simplify managing and updating EOSIO table schemas.</li>
<li>Allow developers to publish reusable smart contract code.</li>
</ul>
<h1><a class="header" href="#getting-help" id="getting-help">Getting Help</a></h1>
<p>If you find a bug or think of an improvement please <a href="https://github.com/sagan-software/eosio-rust/issues/new">open an issue</a> and let us know!</p>
<p>Otherwise if you are stuck on something or run into problems, here are some resources that could help:</p>
<ul>
<li>For questions about this project:
<ul>
<li><a href="https://t.me/eosio_rs">Join our Telegram group</a></li>
<li><a href="https://github.com/sagan-software/eosio-rust/issues/new">Open an issue</a></li>
</ul>
</li>
<li>For questions about EOS development:
<ul>
<li><a href="https://t.me/joinchat/Esi1OkPktgcFeJ3Lmlcrqg">Join the EOS Developers Telegram group</a></li>
<li><a href="https://eosio.stackexchange.com/">Ask on the EOS.IO Stack Exchange</a></li>
<li><a href="https://www.reddit.com/r/eosdev">Ask on r/eosdev</a></li>
</ul>
</li>
<li>For questions about Rust:
<ul>
<li><a href="https://chat.mibbit.com/?server=irc.mozilla.org&amp;channel=%23rust-beginners">Join Mozilla's IRC server</a></li>
<li><a href="https://users.rust-lang.org/">Ask on the Rust user forums</a></li>
<li><a href="https://www.reddit.com/r/rust">Ask on r/rust</a></li>
</ul>
</li>
</ul>
<h1><a class="header" href="#install" id="install">Install</a></h1>
<p>To write EOS smart contracts in Rust we will need to install Rust and setup an EOS local node.</p>
<h1><a class="header" href="#install-rust" id="install-rust">Install Rust</a></h1>
<p>EOSIO Rust works with stable Rust 1.31 and above.</p>
<p>Install Rust with <code>rustup</code> per the <a href="https://www.rust-lang.org/en-US/install.html">official instructions</a>:</p>
<pre><code class="language-sh">curl https://sh.rustup.rs -sSf | sh
</code></pre>
<p>We will also need the <code>wasm32-unknown-unknown</code> target, which can be installed with <code>rustup</code>:</p>
<pre><code class="language-sh">rustup target add wasm32-unknown-unknown
</code></pre>
<h1><a class="header" href="#install-eos" id="install-eos">Install EOS</a></h1>
<p>To test and deploy smart contracts you will want to have a local EOS node running. The easiest way to setup a node is with Docker. See the <a href="https://developers.eos.io/eosio-nodeos/docs/docker-quickstart">official Docker quickstart guide</a> for instructions.</p>
<p>We recommend using <code>docker-compose</code> to manage <code>nodeos</code> and <code>keosd</code> containers. You can download the official <a href="https://raw.githubusercontent.com/EOSIO/eos/master/Docker/docker-compose-latest.yml"><code>docker-compose-latest.yml</code></a> file and start the containers using these commands:</p>
<pre><code class="language-sh">wget https://raw.githubusercontent.com/EOSIO/eos/master/Docker/docker-compose-latest.yml
docker volume create --name=nodeos-data-volume
docker volume create --name=keosd-data-volume
docker-compose -f docker-compose-latest.yml up
</code></pre>
<p><strong>Note #1!</strong> If you are using <code>cleos</code> within a Docker container, you need to mount your project directory as a volume so that <code>cleos</code> can deploy your files. If you're using Docker Compose, add your project directory to the <code>volumes</code> section of the <code>keosd</code> container like so (abbreviated):</p>
<pre><code class="language-yaml">services:
    keosd:
        volumes:
            - ./:mnt/dev/project:ro
</code></pre>
<p><strong>Note #2!</strong> If you are expecting to see console output from <code>nodeos</code> then be sure to add <code>--contracts-console</code> to the end of the <code>nodeosd</code> command like so (abbreviated):</p>
<pre><code class="language-yaml">services:
    nodeosd:
        command: /opt/eosio/bin/nodeosd.sh ... --contracts-console
</code></pre>
<h1><a class="header" href="#optional-dependencies" id="optional-dependencies">Optional Dependencies</a></h1>
<h2><a class="header" href="#wasm-gc" id="wasm-gc">wasm-gc</a></h2>
<p><a href="https://github.com/alexcrichton/wasm-gc">wasm-gc</a> is a command-line tool that removes unused code in WASM files. It can be installed with Cargo:</p>
<pre><code class="language-sh">cargo install wasm-gc
</code></pre>
<h2><a class="header" href="#binaryen" id="binaryen">Binaryen</a></h2>
<p><a href="https://github.com/WebAssembly/binaryen">Binaryen</a> comes with a command-line tool called <code>wasm-opt</code> that optimizes WASM file sizes. Binaryen can be installed with most system package managers.</p>
<h2><a class="header" href="#webassembly-binary-toolkit-wabt" id="webassembly-binary-toolkit-wabt">WebAssembly Binary Toolkit (WABT)</a></h2>
<p><a href="https://github.com/WebAssembly/wabt">WABT</a> comes with a command-line tool <code>wasm2wat</code> that can be used to create textual representations of WASM files, which can be useful for debugging. WABT can be installed with most system package managers.</p>
<h1><a class="header" href="#quick-start" id="quick-start">Quick Start</a></h1>
<p>In this quick-start tutorial we will create a simple EOSIO smart contract in Rust that accepts an account name and prints a greeting message.</p>
<p>Create a new Rust library:</p>
<pre><code class="language-sh">cargo new hello --lib
</code></pre>
<p>Edit <code>Cargo.toml</code>:</p>
<pre><code class="language-toml">[package]
name = &quot;hello&quot;
version = &quot;0.1.0&quot;
edition = &quot;2018&quot;
publish = false

[lib]
crate-type = [&quot;cdylib&quot;]
doc = false

[dependencies]
eosio = { path = &quot;../../crates/eosio&quot; }
eosio_cdt = { path = &quot;../../crates/eosio_cdt&quot; }
</code></pre>
<p>Edit <code>src/lib.rs</code>:</p>
<pre><code class="language-rust no_run noplaypen">#[eosio::action]
fn hi(name: eosio::AccountName) {
    eosio_cdt::print!(&quot;Hello, &quot;, name, &quot;!&quot;);
}

eosio::abi!(hi);
</code></pre>
<p>Compile with the following command:</p>
<pre><code class="language-sh">RUSTFLAGS=&quot;-C link-args=-zstack-size=48000&quot; \
cargo build --release -target=wasm32-unknown-unknown
</code></pre>
<p>The smart contract should now be built at <code>target/wasm32-unknown-unknown/release/hello.wasm</code></p>
<h2><a class="header" href="#deploying" id="deploying">Deploying</a></h2>
<p>Create a new file called <code>abi.json</code> (in future versions this will be automatically generated):</p>
<pre><code class="language-json">{
    &quot;version&quot;: &quot;eosio::abi/1.0&quot;,
    &quot;structs&quot;: [
        {
            &quot;name&quot;: &quot;hi&quot;,
            &quot;base&quot;: &quot;&quot;,
            &quot;fields&quot;: [
                {
                    &quot;name&quot;: &quot;name&quot;,
                    &quot;type&quot;: &quot;name&quot;
                }
            ]
        }
    ],
    &quot;actions&quot;: [
        {
            &quot;name&quot;: &quot;hi&quot;,
            &quot;type&quot;: &quot;hi&quot;
        }
    ]
}
</code></pre>
<p>Assuming you have <code>cleos</code> setup and have created the <code>hello</code> account:</p>
<pre><code class="language-sh">cleos set abi hello abi.json
cleos set code hello target/wasm32-unknown-unknown/release/hello.wasm
</code></pre>
<h2><a class="header" href="#say-hello" id="say-hello">Say Hello</a></h2>
<p>Finally, say hello:</p>
<pre><code class="language-sh">cleos push action hello hi '[&quot;world&quot;]' -p 'hello@active'
</code></pre>
<p>If all went well you should see <code>Hello, world</code> in the console. Otherwise, if the transaction was sent successfully but you don't see any output, you may need to use the <code>--contract-console</code> option with <code>nodeos</code>.</p>
<h1><a class="header" href="#examples" id="examples">Examples</a></h1>
<p>Examples can be found in the <a href="https://github.com/sagan-software/eosio-rust/tree/master/examples"><code>examples</code></a> directory.</p>
<h1><a class="header" href="#hello-world" id="hello-world">Hello, World!</a></h1>
<p>This example shows how to create a smart contract in Rust that prints a greeting, <strong>without using the <code>eosio</code> crate</strong>. This is used to demonstrate the code that is being abstracted away, and to compare the abstraction overhead.</p>
<h2><a class="header" href="#usage" id="usage">Usage</a></h2>
<pre><code class="language-sh">cleos push action hello hi '[&quot;world&quot;]' -p 'hello@active'
</code></pre>
<h2><a class="header" href="#cargotoml" id="cargotoml">Cargo.toml</a></h2>
<pre><code class="language-toml">[package]
name = &quot;hello_bare&quot;
version = &quot;0.1.0&quot;
edition = &quot;2018&quot;
publish = false

[lib]
crate-type = [&quot;cdylib&quot;]
doc = false
</code></pre>
<h2><a class="header" href="#source" id="source">Source</a></h2>
<pre><code class="language-rust no_run noplaypen">// Declare the EOSIO externs to read action data and print to the console.
#[cfg(target_arch = &quot;wasm32&quot;)]
extern &quot;C&quot; {
    pub fn read_action_data(msg: *mut CVoid, len: u32) -&gt; u32;
    pub fn prints_l(cstr: *const u8, len: u32);
    pub fn printn(name: u64);
}

#[repr(u8)]
pub enum CVoid {
    // Two dummy variants so the #[repr] attribute can be used.
    Variant1,
    Variant2,
}

// EOSIO smart contracts are expected to have an `apply` function.
#[cfg(target_arch = &quot;wasm32&quot;)]
#[no_mangle]
pub extern &quot;C&quot; fn apply(_receiver: u64, _code: u64, _action: u64) {
    // First print &quot;Hi, &quot; to the console.
    {
        let msg = &quot;Hi, &quot;;
        let ptr = msg.as_ptr();
        let len = msg.len() as u32;
        unsafe { prints_l(ptr, len) };
    }

    // Read the action data, which is one EOSIO name (a u64, or 8 bytes).
    let name = {
        let mut bytes = [0u8; 8];
        let ptr: *mut CVoid = &amp;mut bytes[..] as *mut _ as *mut CVoid;
        unsafe { read_action_data(ptr, 8) };
        u64::from_le_bytes(bytes)
    };

    // Finally, print the name to the console.
    unsafe { printn(name) };
}
</code></pre>
<h2><a class="header" href="#abi" id="abi">ABI</a></h2>
<pre><code class="language-json">{
    &quot;version&quot;: &quot;eosio::abi/1.0&quot;,
    &quot;structs&quot;: [
        {
            &quot;name&quot;: &quot;hi&quot;,
            &quot;base&quot;: &quot;&quot;,
            &quot;fields&quot;: [
                {
                    &quot;name&quot;: &quot;user&quot;,
                    &quot;type&quot;: &quot;name&quot;
                }
            ]
        }
    ],
    &quot;actions&quot;: [
        {
            &quot;name&quot;: &quot;hi&quot;,
            &quot;type&quot;: &quot;hi&quot;
        }
    ]
}
</code></pre>
<h1><a class="header" href="#hello-world-1" id="hello-world-1">Hello, World!</a></h1>
<p>This example shows how to create a smart contract in Rust that prints a greeting.</p>
<h2><a class="header" href="#usage-1" id="usage-1">Usage</a></h2>
<pre><code class="language-sh">cleos push action hello hi '[&quot;world&quot;]' -p 'hello@active'
</code></pre>
<h2><a class="header" href="#cargotoml-1" id="cargotoml-1">Cargo.toml</a></h2>
<pre><code class="language-toml">[package]
name = &quot;hello&quot;
version = &quot;0.1.0&quot;
edition = &quot;2018&quot;
publish = false

[lib]
crate-type = [&quot;cdylib&quot;]
doc = false

[dependencies]
eosio = { path = &quot;../../crates/eosio&quot; }
eosio_cdt = { path = &quot;../../crates/eosio_cdt&quot; }
</code></pre>
<h2><a class="header" href="#source-1" id="source-1">Source</a></h2>
<pre><code class="language-rust no_run noplaypen">#[eosio::action]
fn hi(name: eosio::AccountName) {
    eosio_cdt::print!(&quot;Hello, &quot;, name, &quot;!&quot;);
}

eosio::abi!(hi);
</code></pre>
<h2><a class="header" href="#abi-1" id="abi-1">ABI</a></h2>
<pre><code class="language-json">{
	&quot;version&quot;: &quot;eosio::abi/1.0&quot;,
	&quot;structs&quot;: [
		{
			&quot;name&quot;: &quot;hi&quot;,
			&quot;base&quot;: &quot;&quot;,
			&quot;fields&quot;: [
				{
					&quot;name&quot;: &quot;user&quot;,
					&quot;type&quot;: &quot;name&quot;
				}
			]
		}
	],
	&quot;actions&quot;: [
		{
			&quot;name&quot;: &quot;hi&quot;,
			&quot;type&quot;: &quot;hi&quot;
		}
	]
}
</code></pre>
<h1><a class="header" href="#tic-tac-toe" id="tic-tac-toe">Tic-Tac-Toe</a></h1>
<p>This example shows how to create a smart contract that reads and writes tables.</p>
<h2><a class="header" href="#usage-2" id="usage-2">Usage</a></h2>
<pre><code class="language-sh">cleos push action tictactoe create '[&quot;alice&quot;,&quot;bob&quot;]' -p 'alice@active'
cleos push action tictactoe makemove '[&quot;alice&quot;,&quot;bob&quot;,1,0,1]' -p 'alice@active'
cleos push action tictactoe restart '[&quot;alice&quot;,&quot;bob&quot;,1]' -p 'alice@active'
cleos push action tictactoe close '[&quot;alice&quot;,&quot;bob&quot;]' -p 'alice@active'
</code></pre>
<h2><a class="header" href="#cargotoml-2" id="cargotoml-2">Cargo.toml</a></h2>
<pre><code class="language-toml">[package]
name = &quot;hello&quot;
version = &quot;0.1.0&quot;
edition = &quot;2018&quot;
publish = false

[lib]
crate-type = [&quot;cdylib&quot;]
doc = false

[dependencies]
eosio = { path = &quot;../../crates/eosio&quot; }
eosio_cdt = { path = &quot;../../crates/eosio_cdt&quot; }
</code></pre>
<h2><a class="header" href="#source-2" id="source-2">Source</a></h2>
<pre><code class="language-rust no_run noplaypen">#[eosio::action]
fn hi(name: eosio::AccountName) {
    eosio_cdt::print!(&quot;Hello, &quot;, name, &quot;!&quot;);
}

eosio::abi!(hi);
</code></pre>
<h2><a class="header" href="#abi-2" id="abi-2">ABI</a></h2>
<pre><code class="language-json">{
	&quot;version&quot;: &quot;eosio::abi/1.0&quot;,
	&quot;structs&quot;: [
		{
			&quot;name&quot;: &quot;hi&quot;,
			&quot;base&quot;: &quot;&quot;,
			&quot;fields&quot;: [
				{
					&quot;name&quot;: &quot;user&quot;,
					&quot;type&quot;: &quot;name&quot;
				}
			]
		}
	],
	&quot;actions&quot;: [
		{
			&quot;name&quot;: &quot;hi&quot;,
			&quot;type&quot;: &quot;hi&quot;
		}
	]
}
</code></pre>
<h1><a class="header" href="#address-book" id="address-book">Address Book</a></h1>
<pre><code class="language-toml">[package]
name = &quot;addressbook&quot;
version = &quot;0.1.0&quot;
edition = &quot;2018&quot;
publish = false

[lib]
crate-type = [&quot;cdylib&quot;]
doc = false

[dependencies]
eosio = { path = &quot;../../crates/eosio&quot; }
eosio_cdt = { path = &quot;../../crates/eosio_cdt&quot; }
</code></pre>
<pre><code class="language-rust no_run noplaypen">use eosio::*;
use eosio_cdt::*;

eosio::abi!(add, update, erase, like, likezip);

#[eosio::table(&quot;address&quot;)]
struct Address {
    #[eosio(primary_key)]
    account: AccountName,
    first_name: String,
    last_name: String,
    street: String,
    city: String,
    state: String,
    #[eosio(secondary_key)]
    zip: u32,
    liked: u64,
}

#[eosio::action]
fn add(
    account: AccountName,
    first_name: String,
    last_name: String,
    street: String,
    city: String,
    state: String,
    zip: u32,
) {
    require_auth(account);

    let code = current_receiver();
    let table = Address::table(code, code);

    let address = table.find(account);
    assert!(address.is_none(), &quot;Address for account already exists&quot;);

    let address = Address {
        account,
        first_name,
        last_name,
        street,
        city,
        state,
        zip,
        liked: 0,
    };
    table.emplace(account, address).expect(&quot;write&quot;);
}

#[eosio::action]
fn update(
    account: AccountName,
    first_name: String,
    last_name: String,
    street: String,
    city: String,
    state: String,
    zip: u32,
) {
    require_auth(account);

    let code = current_receiver();
    let table = Address::table(code, code);
    let cursor = table.find(account).expect(&quot;Address for account not found&quot;);

    let mut address = cursor.get().expect(&quot;read&quot;);
    address.first_name = first_name;
    address.last_name = last_name;
    address.street = street;
    address.city = city;
    address.state = state;
    address.zip = zip;

    cursor.modify(Payer::Same, address).expect(&quot;write&quot;);
}

#[eosio::action]
fn erase(account: AccountName) {
    require_auth(account);

    let code = current_receiver();
    let addresses = Address::table(code, code);
    let cursor = addresses
        .find(account)
        .expect(&quot;Address for account not found&quot;);

    cursor.erase().expect(&quot;read&quot;);
}

#[eosio::action]
fn like(account: AccountName) {
    let code = current_receiver();
    let addresses = Address::table(code, code);
    let cursor = addresses
        .find(account)
        .expect(&quot;Address for account not found&quot;);

    let mut address = cursor.get().expect(&quot;read&quot;);
    address.liked += 1;
    cursor
        .modify(Payer::New(address.account), address)
        .expect(&quot;write&quot;);
}

#[eosio::action]
fn likezip(zip: u32) {
    let code = current_receiver();
    let table = Address::by_zip(code, code);
    for cursor in table.lower_bound(zip).into_iter() {
        let mut addr = cursor.get().expect(&quot;read&quot;);
        if addr.zip != zip {
            break;
        }
        addr.liked += 1;
        cursor.modify(Payer::Same, addr).expect(&quot;write&quot;);
    }
}
</code></pre>
<h1><a class="header" href="#user-guide" id="user-guide">User Guide</a></h1>
<p>In this guide we will go through the basics of developing EOSIO smart contracts with Rust. For other guides on EOSIO software please see block.one's <a href="https://developers.eos.io/">EOSIO developer portal</a>.</p>
<h1><a class="header" href="#declaring-actions" id="declaring-actions">Declaring Actions</a></h1>
<h1><a class="header" href="#tables" id="tables">Tables</a></h1>
<h1><a class="header" href="#using-secondary-keys" id="using-secondary-keys">Using Secondary Keys</a></h1>
<h1><a class="header" href="#deriving-common-traits" id="deriving-common-traits">Deriving Common Traits</a></h1>
<h1><a class="header" href="#compiling-smart-contracts" id="compiling-smart-contracts">Compiling Smart Contracts</a></h1>
<h1><a class="header" href="#deploying-smart-contracts" id="deploying-smart-contracts">Deploying Smart Contracts</a></h1>
<h1><a class="header" href="#optimizing-wasm-files" id="optimizing-wasm-files">Optimizing WASM files</a></h1>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                

                
            </nav>

        </div>

        

        

        
        
        
        <script type="text/javascript">
            window.playpen_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        
        
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
        
        

    </body>
</html>
